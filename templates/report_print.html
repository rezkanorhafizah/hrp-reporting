<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>{{ judul }}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { font-family: 'Times New Roman', Times, serif; font-size: 12pt; }
        
        /* KOP SURAT */
        .kop-surat { text-align: center; border-bottom: 3px double black; padding-bottom: 10px; margin-bottom: 20px; }
        .kop-instansi { font-size: 16pt; font-weight: bold; }
        .kop-judul { font-size: 14pt; font-weight: bold; }
        .kop-lokasi { font-size: 11pt; font-style: italic; }

        /* TABEL RAPI */
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { border: 1px solid black; padding: 8px; vertical-align: middle; }
        
        /* KUNCI HEADER BERULANG: ini bikin header muncul di tiap halaman */
        thead { display: table-header-group; } 
        tr { page-break-inside: avoid; } /* Baris gak boleh kepotong */

        /* STYLE KHUSUS PRINT */
        @media print {
            .no-print { display: none !important; } /* Sembunyikan tombol saat print */
            @page { margin: 2cm; size: landscape; } /* Otomatis Landscape */
            body { -webkit-print-color-adjust: exact; } /* Paksa warna background keluar */
        }
        
        .bg-hijau { background-color: #d4edda !important; font-weight: bold; }
        .text-merah { color: #dc3545 !important; font-weight: bold; }
    </style>
</head>
<body class="p-4">

    <div class="no-print fixed-top bg-dark p-2 text-center text-white">
        <span class="me-3">Mode Pratinjau Cetak</span>
        <button onclick="window.print()" class="btn btn-warning fw-bold btn-sm">üñ®Ô∏è CETAK / SIMPAN PDF</button>
        <a href="{% url 'home' %}" class="btn btn-secondary btn-sm ms-2">Kembali</a>
    </div>
    <div style="height: 50px;" class="no-print"></div>

    <div class="kop-surat position-relative">
        <img src="/media/logo_hafecs.png" style="position: absolute; left: 0; top: 0; height: 70px;">
        <img src="/media/logo_disdik.png" style="position: absolute; right: 0; top: 0; height: 70px;">
        
        <div class="kop-instansi">HAFECS Research and Publication (HRP)</div>
        <div class="kop-judul">LAPORAN EVALUASI PELATIHAN GURU</div>
        <div class="kop-lokasi">Lokasi: Kabupaten Barito Kuala - Tanggal Cetak: {{ generated_at }}</div>
    </div>

    <h4 class="text-center mb-4 fw-bold text-uppercase">{{ judul }}</h4>

    {% if tipe == 'kepuasan' %}
    <table class="table table-bordered">
        <thead class="table-success text-center align-middle">
            <tr>
                <th width="5%">No</th>
                <th>Aspek Penilaian</th>
                <th width="10%">Total Resp.</th>
                <th width="10%">Skor 4 & 5</th>
                <th width="10%">Kepuasan</th>
            </tr>
        </thead>
        <tbody>
            {% for row in data_tabel %}
            <tr>
                <td class="text-center">{{ forloop.counter }}</td>
                <td>{{ row.aspek }}</td>
                <td class="text-center">{{ row.tot }}</td>
                <td class="text-center">{{ row.puas }}</td>
                <td class="text-center {% if row.pct >= 80 %}bg-hijau{% endif %}">
                    {{ row.pct|floatformat:1 }}%
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    {% if tipe == 'trainer' %}
    <table class="table table-bordered">
        <thead class="table-primary text-center align-middle">
            <tr>
                <th width="5%">No</th>
                <th width="40%">Instrumen Penilaian</th>
                {% for t in trainer_names %}
                <th>{{ t }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in data_trainer %}
            <tr>
                <td class="text-center">{{ forloop.counter }}</td>
                <td>{{ row.instrumen }}</td>
                {% for val in row.trainers %}
                <td class="text-center fw-bold">
                    {{ val }}
                </td>
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    <div class="mt-4 small text-muted fst-italic">
        * Dokumen ini digenerate otomatis oleh Sistem HRP.
    </div>

</body>
</html>